<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#0052CC">
  <link rel="manifest" href="/app-Evangebla/manifest.json">
  <link rel="apple-touch-icon" href="/app-Evangebla/icon.png">
  <!-- Google Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Chart.js y librerías -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <title>EVANG_EBLA</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: Arial, sans-serif; }
    .sidebar { position: fixed; top: 0; left: 0; width: 200px; height: 100vh; background: #0052cc; display: flex; flex-direction: column; align-items: center; padding-top: 1rem; box-shadow: 2px 0 5px rgba(0,0,0,0.1); z-index: 1000; }
    .sidebar img { width: 60px; height: 60px; margin-bottom: 1rem; border-radius: 8px; }
    .btn-nav { width: 100%; background: #0052cc; color: #fff; border: none; text-align: left; padding: 0.75rem 1rem; cursor: pointer; font-size: 0.95rem; display: flex; align-items: center; transition: background 0.2s; }
    .btn-nav .material-icons { font-size: 1.2em; margin-right: 8px; }
    .btn-nav:hover, .btn-nav.active { background: #003d99; }
    .content { margin-left: 200px; padding: 1rem; }
    .section { display: none; }
    .section.active { display: block; }
    form input, form select, form textarea { width: 100%; padding: 0.5rem; margin-bottom: 0.75rem; border: 1px solid #ccc; border-radius: 4px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    .chart-container { width: 100%; height: 300px; margin-bottom: 1rem; }
    @media (max-width: 768px) {
      .sidebar { width: 100%; height: auto; flex-direction: row; overflow-x: auto; padding: 0.5rem; white-space: nowrap; }
      .sidebar img { display: none; }
      .btn-nav { width: auto; padding: 0.5rem; font-size: 0.9rem; justify-content: center; }
      .content { margin-left: 0; padding-top: calc(0.5rem + 2.5rem); }
    }
  </style>
</head>
<body>
  <aside class="sidebar">
    <img src="/app-Evangebla/icon.png" alt="Icono EVANG_EBLA" />
    <button data-section="splash" class="btn-nav active" type="button"><span class="material-icons">home</span>Inicio</button>
    <button data-section="registro" class="btn-nav" type="button"><span class="material-icons">person_add</span>Registro</button>
    <button data-section="historial" class="btn-nav" type="button"><span class="material-icons">history</span>Historial</button>
    <button data-section="seguimiento" class="btn-nav" type="button"><span class="material-icons">track_changes</span>Seguimiento</button>
    <button data-section="reportes" class="btn-nav" type="button"><span class="material-icons">description</span>Reportes</button>
    <button data-section="grupos" class="btn-nav" type="button"><span class="material-icons">group</span>Grupos</button>
    <button data-section="bautismo" class="btn-nav" type="button"><span class="material-icons">water_drop</span>Bautismo</button>
    <button data-section="calendario" class="btn-nav" type="button"><span class="material-icons">calendar_month</span>Calendario</button>
  </aside>

  <main class="content">
    <!-- ... todas las secciones previas ... -->
    <section id="registro" class="section">
      <h2>Registro de Contacto</h2>
      <form id="form-contacto">
        <input type="text" name="nombre" placeholder="Nombre" required />
        <input type="number" name="edad" placeholder="Edad" required />
        <input type="tel" name="telefono" placeholder="Teléfono" required />
        <select name="genero" required><option value="">Género</option><option>Masculino</option><option>Femenino</option></select>
        <input type="text" name="ubicacion" placeholder="Ubicación" />
        <label><input type="checkbox" name="aceptoCristo" /> Aceptó a Cristo</label>
        <label><input type="checkbox" name="bautizado" /> Bautizado</label>
        <label><input type="checkbox" name="discipulado" /> Desea discipulado</label>
        <button type="submit" class="btn-nav" type="button"><span class="material-icons">save</span>Guardar</button>
      </form>
    </section>
    <!-- ... otras secciones ... -->
    <section id="reportes" class="section">
      <h2>Reportes y Estadísticas</h2>
      <label for="mes-select">Mes:</label><input type="month" id="mes-select" />
      <div class="chart-container"><canvas id="chart-estadisticas"></canvas></div>
      <button id="add-report" class="btn-nav" type="button"><span class="material-icons">add_circle</span>Reporte</button>
      <div id="form-reporte" style="display:none; margin-top:1rem;">
        <select id="reporte-contacto"><option value="">Selecciona Miembro</option></select>
        <textarea id="reporte-texto" placeholder="Describe la comunicación"></textarea>
        <button id="save-reporte" class="btn-nav" type="button"><span class="material-icons">save</span>Guardar Reporte</button>
      </div>
      <ul id="lista-reportes"></ul>
    </section>
  </main>

  <script>
    // Datos de contactos en memoria
    window.contactos = [];

    // Navegación entre secciones
    document.querySelectorAll('.btn-nav[data-section]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.btn-nav').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const sec = btn.getAttribute('data-section');
        document.querySelectorAll('.section').forEach(s => s.classList.toggle('active', s.id === sec));
        if(sec === 'reportes') toggleReportForm();
      });
    });

    // Al registrar contacto, añadir a contactos
    document.getElementById('form-contacto').addEventListener('submit', e => {
      e.preventDefault();
      const form = e.target;
      const nuevo = {
        id: Date.now(),
        nombre: form.nombre.value,
        edad: form.edad.value,
        telefono: form.telefono.value
      };
      window.contactos.push(nuevo);
      alert('Contacto guardado: ' + nuevo.nombre);
      form.reset();
    });

    // Toggle y carga de reporte
    function toggleReportForm() {
      const form = document.getElementById('form-reporte');
      form.style.display = form.style.display === 'block' ? 'none' : 'block';
      if(form.style.display === 'block') {
        const sel = document.getElementById('reporte-contacto');
        sel.innerHTML = '<option value="">Selecciona Miembro</option>';
        window.contactos.forEach(c => sel.innerHTML += `<option value="${c.id}">${c.nombre}</option>`);
      }
    }

    document.getElementById('add-report').addEventListener('click', toggleReportForm);
    document.getElementById('save-reporte').addEventListener('click', () => {
      const id = document.getElementById('reporte-contacto').value;
      const txt = document.getElementById('reporte-texto').value.trim();
      if(!id || !txt) return alert('Selecciona un miembro y escribe la comunicación.');
      alert('Reporte guardado para ID ' + id);
      document.getElementById('form-reporte').style.display = 'none';
    });
  </script>
</body>
</html>
